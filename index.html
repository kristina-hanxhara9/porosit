<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flavor Factory - Porosisni Produkte</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f3e9;
            color: #5a3921;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #8b4513;
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 8px 8px 0 0;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin: 0;
        }
        
        h2 {
            color: #8b4513;
            border-bottom: 2px solid #8b4513;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        .products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .product-card {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 10px;
        }
        
        .product-card h3 {
            margin: 10px 0;
            font-size: 1.2rem;
        }
        
        .product-card p {
            font-weight: bold;
            margin: 5px 0;
        }
        
        .product-card button {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
            transition: background-color 0.3s;
        }
        
        .product-card button:hover {
            background-color: #6b3000;
        }
        
        .cart-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }
        
        .cart-items {
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }
        
        .cart-total {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: right;
            margin: 20px 0;
        }
        
        .limit-warning {
            color: red;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
            display: none;
        }
        
        form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            form {
                grid-template-columns: 1fr;
            }
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .submit-btn {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2rem;
            grid-column: 1 / -1;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: #3e8e41;
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 5px;
        }
        
        .quantity-controls button {
            background-color: #8b4513;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .quantity-controls span {
            margin: 0 10px;
            font-weight: bold;
        }
        
        .category-nav {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .category-btn {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .category-btn:hover, .category-btn.active {
            background-color: #6b3000;
        }
        
        /* Custom Cake Section Styles */
        .custom-cake-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }
        
        .cake-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .cake-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s;
        }
        
        .cake-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .cake-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        
        .cake-card-content {
            padding: 15px;
        }
        
        .cake-card h3 {
            margin: 0 0 10px 0;
            color: #8b4513;
        }
        
        .cake-card p {
            margin: 5px 0;
        }
        
        .cake-card button {
            background-color: #8b4513;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 10px;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        .cake-card button:hover {
            background-color: #6b3000;
        }
        
        .custom-cake-form {
            margin-top: 20px;
            display: none;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        .cake-detail-img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Furra Jonë</h1>
            <p>Porositni produktet tuaja të preferuara të pjekura</p>
        </div>
    </header>
    
    <div class="container">
        <div class="category-nav">
            <button class="category-btn active" data-category="all">Të Gjitha</button>
            <button class="category-btn" data-category="buke">Bukë</button>
            <button class="category-btn" data-category="embelsira">Ëmbëlsira</button>
            <button class="category-btn" data-category="produkte-qumeshti">Produkte Bulmeti</button>
            <button class="category-btn" data-category="torta-porosi">Torta me porosi</button>
            <button class="category-btn" data-category="te-tjera">Të Tjera</button>
        </div>
        
        <div class="products" id="products-container">
            <!-- Products will be added here by JavaScript -->
        </div>
        
        <!-- Modal for custom cakes -->
        <div id="cake-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div id="cake-modal-content">
                    <!-- Cake details will be added here -->
                </div>
            </div>
        </div>
        
        <div class="cart-section">
            <h2>Shporta Juaj</h2>
            <div class="limit-warning" id="limit-warning">
                Kujdes: Porosia ka kaluar limitin prej 1,000 LEKE!
            </div>
            <div class="cart-items" id="cart-items">
                <p>Nuk keni asnjë produkt në shportë</p>
            </div>
            <div class="cart-total">
                Totali: <span id="cart-total">0.00</span> LEKE
            </div>
            
            <h2>Informacioni i Dorëzimit</h2>
            <form id="order-form">
                <div>
                    <label for="name">Emri dhe Mbiemri:</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div>
                    <label for="phone">Numri i Telefonit:</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div>
                    <label for="address">Adresa:</label>
                    <input type="text" id="address" name="address" required>
                </div>
                <div>
                    <label for="delivery-date">Data e Dorëzimit:</label>
                    <input type="date" id="delivery-date" name="delivery-date" required>
                </div>
                <div>
                    <label for="delivery-time">Koha e Dorëzimit:</label>
                    <select id="delivery-time" name="delivery-time" required>
                        <option value="">Zgjidhni kohën</option>
                        <option value="9:00 - 11:00">9:00 - 11:00</option>
                        <option value="11:00 - 13:00">11:00 - 13:00</option>
                        <option value="13:00 - 15:00">13:00 - 15:00</option>
                        <option value="15:00 - 17:00">15:00 - 17:00</option>
                        <option value="17:00 - 19:00">17:00 - 19:00</option>
                    </select>
                </div>
                <div>
                    <label for="notes">Shënime shtesë:</label>
                    <textarea id="notes" name="notes" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn">Porosit / Ma Sill në Shtëpi</button>
            </form>
        </div>
    </div>

    <script>
        // All bakery products data (including custom cakes)
        const bakeryData = [
            { id: 1, product: "Ekmek", price: 1.5, category: "buke", image: "https://placehold.co/200x150/brown/white?text=Ekmek" },
            { id: 2, product: "Torte", price: 12.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Torte" },
            { id: 3, product: "Zupa", price: 1.000, category: "te-tjera", image: "https://placehold.co/200x150/orange/white?text=Zupa" },
            { id: 4, product: "Trilece", price: 5.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Trilece" },
            { id: 5, product: "Kausha", price: 10.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Kausha" },
            { id: 6, product: "Peta", price: 1.000, category: "te-tjera", image: "https://placehold.co/200x150/orange/white?text=Peta" },
            { id: 7, product: "Rulon", price: 10.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Rulon" },
            { id: 8, product: "Pastashu", price: 1.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Pastashu" },
            { id: 9, product: "Kompeka", price: 10.000, category: "embelsira", image: "https://placehold.co/200x150/pink/white?text=Kompeka" },
            { id: 10, product: "Bakllava", price: 10.000, category: "embelsira", image: "images/bakllave.jpg" },
            { id: 11, product: "Torte racion", price: 1.5, category: "embelsira", image: "images/copa.jpg" },
            { id: 12, product: "Porcione", price: 12.000, category: "embelsira", image: "https://via.placeholder.com/200x150?text=Porcione" },
            { id: 13, product: "Tolluma", price: 1.5, category: "embelsira", image: "https://via.placeholder.com/200x150?text=Tolluma" },
            { id: 14, product: "Buke franxholla", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+franxholla" },
            { id: 15, product: "Franxholla", price: 6.000, category: "buke", image: "images/buke.jpg" },
            { id: 16, product: "Buke me topa", price: 10.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+me+topa" },
            { id: 17, product: "Buke masive", price: 1.5, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+masive" },
            { id: 18, product: "Buke me fara", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+me+fara" },
            { id: 19, product: "Buke fshati", price: 10.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+fshati" },
            { id: 20, product: "Buke e rrumbullaket", price: 1.5, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+e+rrumbullaket" },
            { id: 21, product: "Buke e gjate", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+e+gjate" },
            { id: 22, product: "Kulac", price: 6.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Kulac" },
            { id: 23, product: "Buke me ullinj", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+me+ullinj" },
            { id: 24, product: "Buke e verdhe", price: 6.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+e+verdhe" },
            { id: 25, product: "Buke integrale", price: 10.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+integrale" },
            { id: 26, product: "Buke Bogeti", price: 1.5, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+Bogeti" },
            { id: 27, product: "Buke misri", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+misri" },
            { id: 28, product: "Buke thekre", price: 10.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Buke+thekre" },
            { id: 29, product: "Pite", price: 1.5, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Pite" },
            { id: 30, product: "Simite", price: 12.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Simite" },
            { id: 31, product: "Sanduic", price: 6.000, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Sanduic" },
            { id: 32, product: "Sanduic me fara", price: 12.000, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Sanduic+me+fara" },
            { id: 33, product: "Sanduic i verdhe", price: 6.000, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Sanduic+i+verdhe" },
            { id: 34, product: "Briosh", price: 10.000, category: "buke", image: "https://via.placeholder.com/200x150?text=Briosh" },
            { id: 35, product: "Donat", price: 1.5, category: "embelsira", image: "https://via.placeholder.com/200x150?text=Donat" },
            { id: 36, product: "Byrek", price: 5.00, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Byrek" },
            { id: 37, product: "Pica", price: 1.5, category: "te-tjera", image: "images/pica.jpg" },
            { id: 38, product: "Kos 380gr", price: 12.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Kos+380gr" },
            { id: 39, product: "Kos bidon", price: 6.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Kos+bidon" },
            { id: 40, product: "Kos i madh", price: 12.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Kos+i+madh" },
            { id: 41, product: "Kos 200", price: 6.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Kos+200" },
            { id: 42, product: "Dhalle bidon", price: 10.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Dhalle+bidon" },
            { id: 43, product: "Salce kosi 900gr", price: 10.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Salce+kosi" },
            { id: 44, product: "Boze", price: 6.000, category: "produkte-qumeshti", image: "https://via.placeholder.com/200x150?text=Boze" },
            { id: 45, product: "Uje Bukanik 7kg", price: 1.5, category: "te-tjera", image: "https://via.placeholder.com/200x150?text=Uje+Bukanik" },
            // Custom cakes
            { 
                id: 101, 
                product: "Torte Ditëlindje", 
                price: 25.00, 
                category: "torta-porosi", 
                image: "images/birthday.jpg",
                isCustomCake: true,
                description: "Torte e përshtatshme për festa ditëlindjeje. E disponueshme në shumë shije dhe dekorime.",
                flavors: ["Çokollatë", "Vanilje", "Dredhëz", "Karamel"],
                sizes: ["1 kg", "2 kg", "3 kg", "5 kg"]
            },
            { 
                id: 102, 
                product: "Torte Dasme", 
                price: 45.00, 
                category: "torta-porosi", 
                image: "https://placehold.co/300x200/white/black?text=Torte+Dasme",
                isCustomCake: true,
                description: "Torte elegante për ditën e veçantë të dasmës suaj. Dizajne të personalizuara.",
                flavors: ["Çokollatë", "Vanilje", "Bajame", "Lëng Frutash"],
                sizes: ["3 kg", "5 kg", "8 kg", "10 kg"]
            },
            { 
                id: 103, 
                product: "Torte për Fëmijë", 
                price: 22.00, 
                category: "torta-porosi", 
                image: "images/birthday.jpg",
                isCustomCake: true,
                description: "Torte me tema të ndryshme për fëmijë. Personazhe vizatimor dhe ngjyra të gjalla.",
                flavors: ["Çokollatë", "Vanilje", "Frutat e Pyllit", "Luleshtrydhe"],
                sizes: ["1 kg", "2 kg", "3 kg"]
            },
            { 
                id: 104, 
                product: "Torte Çokollatë", 
                price: 20.00, 
                category: "torta-porosi", 
                image: "images/ferrero.jpg",
                isCustomCake: true,
                description: "Torte e pasur me çokollatë. Ideale për dashuritë e çokollatës.",
                flavors: ["Çokollatë e Zezë", "Çokollatë Qumështi", "Çokollatë me Arra"],
                sizes: ["1 kg", "2 kg", "3 kg"]
            },
            { 
                id: 105, 
                product: "Torte Frutash", 
                price: 23.00, 
                category: "torta-porosi", 
                image: "https://via.placeholder.com/300x200?text=Torte+Frutash",
                isCustomCake: true,
                description: "Torte e lehtë me përbërës frutash të freskët sezonalë.",
                flavors: ["Përzierje Frutash", "Kivi", "Portokall", "Mango"],
                sizes: ["1 kg", "2 kg", "3 kg"]
            },
            { 
                id: 106, 
                product: "Torte Jubileu", 
                price: 30.00, 
                category: "torta-porosi", 
                image: "https://via.placeholder.com/300x200?text=Torte+Jubileu",
                isCustomCake: true,
                description: "Torte speciale për përvjetorë dhe jubile. Dekorime elegante.",
                flavors: ["Çokollatë", "Vanilje", "Karamel", "Bajame"],
                sizes: ["2 kg", "3 kg", "5 kg"]
            }
        ];

        // Shopping cart array
        let cart = [];
        const LIMIT = 1000;
        
        // Telegram Bot configuration
        const TELEGRAM_BOT_TOKEN = "7623771690:AAEF50LWPC-xJ-qJ2w1C8lMu6sUwkve3ZSY"; // Replace with your actual bot token
        const TELEGRAM_CHAT_ID = "7546090059"; // Replace with your chat ID

        // DOM elements
        const productsContainer = document.getElementById('products-container');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotalElement = document.getElementById('cart-total');
        const limitWarning = document.getElementById('limit-warning');
        const orderForm = document.getElementById('order-form');
        const categoryButtons = document.querySelectorAll('.category-btn');
        const cakeModal = document.getElementById('cake-modal');
        const cakeModalContent = document.getElementById('cake-modal-content');
        const closeModal = document.querySelector('.close');

        // Set min date to today and max date to 1 month from now
        const today = new Date();
        const oneMonthLater = new Date();
        oneMonthLater.setMonth(today.getMonth() + 1);
        
        const deliveryDateInput = document.getElementById('delivery-date');
        deliveryDateInput.min = today.toISOString().split('T')[0];
        deliveryDateInput.max = oneMonthLater.toISOString().split('T')[0];
        deliveryDateInput.value = today.toISOString().split('T')[0];

        // Display products
        function displayProducts(category = 'all') {
            productsContainer.innerHTML = '';
            
            const filteredProducts = category === 'all' 
                ? bakeryData 
                : bakeryData.filter(product => product.category === category);
                
            filteredProducts.forEach(item => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                if (item.isCustomCake) {
                    // Display custom cake product
                    productCard.innerHTML = `
                        <img src="${item.image}" alt="${item.product}">
                        <h3>${item.product}</h3>
                        <p>${item.price.toFixed(2)} LEKE / kg</p>
                        <button class="view-cake-btn" data-id="${item.id}">Shiko detajet</button>
                    `;
                } else {
                    // Display regular product
                    productCard.innerHTML = `
                        <img src="${item.image}" alt="${item.product}">
                        <h3>${item.product}</h3>
                        <p>${item.price.toFixed(2)} LEKE</p>
                        <div class="quantity-controls">
                            <button class="minus-btn" data-id="${item.id}">-</button>
                            <span class="quantity" data-id="${item.id}">0</span>
                            <button class="plus-btn" data-id="${item.id}">+</button>
                        </div>
                    `;
                }
                
                productsContainer.appendChild(productCard);
            });
            
            // Add event listeners to plus and minus buttons for regular products
            document.querySelectorAll('.plus-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const productId = parseInt(button.getAttribute('data-id'));
                    addToCart(productId);
                });
            });
            
            document.querySelectorAll('.minus-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const productId = parseInt(button.getAttribute('data-id'));
                    removeFromCart(productId);
                });
            });
            
            // Add event listeners for custom cake details
            document.querySelectorAll('.view-cake-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const cakeId = parseInt(button.getAttribute('data-id'));
                    openCakeModal(cakeId);
                });
            });
        }
        
        // Open cake modal
        function openCakeModal(cakeId) {
            const cake = bakeryData.find(c => c.id === cakeId && c.isCustomCake);
            
            if (!cake) return;
            
            cakeModalContent.innerHTML = `
                <img src="${cake.image}" alt="${cake.product}" class="cake-detail-img">
                <h2>${cake.product}</h2>
                <p>${cake.description}</p>
                <p><strong>Çmimi:</strong> ${cake.price.toFixed(2)} LEKE / kg</p>
                
                <div class="form-group">
                    <label for="cake-size">Zgjidhni Madhësinë:</label>
                    <select id="cake-size" class="cake-size">
                        ${cake.sizes.map(size => `<option value="${size}">${size}</option>`).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="cake-flavor">Zgjidhni Shijen:</label>
                    <select id="cake-flavor" class="cake-flavor">
                        ${cake.flavors.map(flavor => `<option value="${flavor}">${flavor}</option>`).join('')}
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="cake-message">Mesazhi në Tortë (opsionale):</label>
                    <input type="text" id="cake-message" class="cake-message" placeholder="p.sh. Gëzuar Ditëlindjen!">
                </div>
                
                <button id="add-cake-to-cart" class="submit-btn" data-id="${cake.id}">Shto në Shportë</button>
            `;
            
            cakeModal.style.display = 'block';
            
            // Add event listener to Add to Cart button
            document.getElementById('add-cake-to-cart').addEventListener('click', () => {
                const size = document.getElementById('cake-size').value;
                const flavor = document.getElementById('cake-flavor').value;
                const message = document.getElementById('cake-message').value;
                
                // Calculate price based on size
                let multiplier = 1;
                if (size === "2 kg") multiplier = 2;
                else if (size === "3 kg") multiplier = 3;
                else if (size === "5 kg") multiplier = 5;
                else if (size === "8 kg") multiplier = 8;
                else if (size === "10 kg") multiplier = 10;
                
                const totalPrice = cake.price * multiplier;
                
                // Add to cart
                cart.push({
                    id: `custom-${cake.id}-${Date.now()}`, // Unique ID
                    product: `${cake.product} (${size}, ${flavor})`,
                    price: totalPrice,
                    quantity: 1,
                    customDetails: {
                        cakeId: cake.id,
                        size: size,
                        flavor: flavor,
                        message: message
                    }
                });
                
                updateCart();
                cakeModal.style.display = 'none';
                alert(`"${cake.product}" u shtua në shportë!`);
            });
        }
        
        // Close modal when clicking on X
        closeModal.addEventListener('click', () => {
            cakeModal.style.display = 'none';
        });
        
        // Close modal when clicking outside of it
        window.addEventListener('click', (event) => {
            if (event.target === cakeModal) {
                cakeModal.style.display = 'none';
            }
        });

        // Category filter
        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                categoryButtons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Get category and display filtered products
                const category = button.getAttribute('data-category');
                displayProducts(category);
                
                // Update quantity numbers for products in cart
                updateQuantityDisplay();
            });
        });

        // Add to cart function
        function addToCart(productId) {
            const product = bakeryData.find(item => item.id === productId);
            
            if (!product) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    product: product.product,
                    price: product.price,
                    quantity: 1
                });
            }
            
            updateCart();
            updateQuantityDisplay();
        }

        // Remove from cart function
        function removeFromCart(productId) {
            const itemIndex = cart.findIndex(item => item.id === productId);
            
            if (itemIndex === -1) return;
            
            if (cart[itemIndex].quantity > 1) {
                cart[itemIndex].quantity -= 1;
            } else {
                cart.splice(itemIndex, 1);
            }
            
            updateCart();
            updateQuantityDisplay();
        }

        // Update quantity display in product cards
        function updateQuantityDisplay() {
            document.querySelectorAll('.quantity').forEach(element => {
                const productId = parseInt(element.getAttribute('data-id'));
                const cartItem = cart.find(item => item.id === productId);
                
                element.textContent = cartItem ? cartItem.quantity : 0;
            });
        }

        // Update cart display
        function updateCart() {
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p>Nuk keni asnjë produkt në shportë</p>';
                cartTotalElement.textContent = '0.00';
                limitWarning.style.display = 'none';
                return;
            }
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                cartItem.innerHTML = `
                    <div>${item.product} x ${item.quantity}</div>
                    <div>${itemTotal.toFixed(2)} LEKE</div>
                `;
                
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalElement.textContent = total.toFixed(2);
            
            // Check if total exceeds limit
            if (total > LIMIT) {
                limitWarning.style.display = 'block';
            } else {
                limitWarning.style.display = 'none';
            }
        }
        
        // Send order to Telegram
        async function sendOrderToTelegram(orderData) {
            try {
                // Format message
                let message = "🔔 *POROSIA E RE* 🔔\n\n";
                message += `*Klienti:* ${orderData.name}\n`;
                message += `*Telefoni:* ${orderData.phone}\n`;
                message += `*Adresa:* ${orderData.address}\n`;
                message += `*Data e Dorëzimit:* ${orderData.deliveryDate}\n`;
                message += `*Koha e Dorëzimit:* ${orderData.deliveryTime}\n\n`;
                
                message += "*Produktet:*\n";
                orderData.items.forEach(item => {
                    message += `- ${item.product} x ${item.quantity}: ${(item.price * item.quantity).toFixed(2)} LEKE\n`;
                    
                    // Add custom cake details if applicable
                    if (item.customDetails) {
                        message += `  • Madhësia: ${item.customDetails.size}\n`;
                        message += `  • Shija: ${item.customDetails.flavor}\n`;
                        if (item.customDetails.message) {
                            message += `  • Mesazhi: "${item.customDetails.message}"\n`;
                        }
                    }
                });
                
                message += `\n*TOTALI:* ${orderData.total.toFixed(2)} LEKE\n`;
                
                if (orderData.notes) {
                    message += `\n*Shënime:* ${orderData.notes}\n`;
                }
                
                // Encode message for URL
                const encodedMessage = encodeURIComponent(message);
                
                // Send to Telegram
                const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${encodedMessage}&parse_mode=Markdown`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                return data.ok;
            } catch (error) {
                console.error('Error sending to Telegram:', error);
                return false;
            }
        }

        // Handle form submission
        orderForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const total = parseFloat(cartTotalElement.textContent);
            
            if (total === 0) {
                alert('Ju lutem shtoni të paktën një produkt në shportë për të vazhduar!');
                return;
            }
            
            if (total > LIMIT) {
                alert('Porosia juaj kalon limitin prej 1,000 LEKE. Ju lutem reduktoni sasinë.');
                return;
            }
            
            // Collect form data
            const formData = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                address: document.getElementById('address').value,
                deliveryDate: document.getElementById('delivery-date').value,
                deliveryTime: document.getElementById('delivery-time').value,
                notes: document.getElementById('notes').value,
                items: cart,
                total: total
            };
            
            // Send to Telegram
            const isOrderSent = await sendOrderToTelegram(formData);
            
            if (isOrderSent) {
                alert('Porosia juaj u dërgua me sukses! Do t\'ju kontaktojmë së shpejti.');
                
                // Reset form and cart
                orderForm.reset();
                cart = [];
                updateCart();
                updateQuantityDisplay();
            } else {
                alert('Ka ndodhur një gabim gjatë dërgimit të porosisë. Ju lutemi provoni përsëri ose na kontaktoni drejtpërdrejt.');
            }
        });

        // Initialize the page
        displayProducts();
    </script>
</body>
</html>
